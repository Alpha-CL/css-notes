# 性能优化

#### CPU( 处理器 ) GPU( 显卡 )

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * CPU 基于逻辑的数据运算               // xx CPU = 1 GPU 运算速率
 * 
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * GPU 显卡图像绘制                    // 高精度浮点数运算
 * 
 * 区块链
 */

// 浏览器默认刷新页面频率  1s / 60次 约等于 16.7mm
//
// 当 GPU 足够强大，浏览器可以在一帧里渲染好页面，则当你再次修改元素或改动动画时，将会非常流畅

家用-绘制单位: 多边形

专业-绘制单位: 点                      // 浏览器默认为点阵渲染


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * domTree & cssTree 结构 类似
 * 
 * renderTree: 渲染树，每个节点附近都带有 css 属性，以便于构建页面         // 仅绘制需要绘制的元素结构( eg: display: none; 去除 )
 */


             // 修改部分 CSS 样式，会先改变 cssTree，然后修改 renderTree 上对应 Node 的属性( css ) 即可   
             
            | --> repaint( 重绘 ) -> 影响效率较少                              // repaint
            |        |
            |        | --> color
            |        | 
            |        | --> width / height ...
            |
            |
domTree + cssTree => renderTree -> 辨识 Node -> 深度优先解析
   |                            ｜                           => end => domTree 解析完毕 =>
   |                            -> 异步加载 img 等
   |
   |
   |         // 修改 DOM 节点会重排 renderTree( reflow: 页面重构 ) -> 影响效率较多         
   |                     
   + ---> change DomNode -> domTree => reflow(重排) -> renderTree             // reflow -> repaint             
            ｜
            ｜
            ｜--> 节点( 删除 / 添加 )
            ｜
            ｜--> dom 节点的宽高变化，display( none / block )
            ｜
            ｜--> offsetWidth offsetLeft                                            

    
=> layout( 布局 ) => paint( 绘制 ) => 逻辑上( 多层矢量图 ) => 实际绘制( 删格化 ) => Browser Set (CPU | GPU) paint

                                                                              大多数浏览器目前都可以设置
                                                                              ( 默认设置为 GPU 绘制 )
                                                                              
                                                                              
//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * reflow
 * 
 * 改变窗口大小 | 改变文字大小 | 内容改变 | 输入框输入文字 | 激活伪类(eg: hover) | 操作 class 属性 | 脚本操作DOM
 * 
 * 计算 offsetWidth & offsetHeight | 设置 style 属性 
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * repaint
 * 
 * 只改变某个元素的(背景色 | 文字颜色 | 边框颜色)，并不影响它周围或呢诶不布局的属性
 * 
 *  
 * repaint 速度大于 reflow
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### will-change

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// old method

/**
 * transformZ(0); | transform3d(0, 0, 0); ...                   // 结尾处添加
 * 
 * 告知浏览器提前准备
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// new method

/**
 * will-change: attributeName;
 * 
 * chrome 40.0+                         // 兼容性较高
 * 
 * 
 * 监听 attributeName，并把 attributeName 在单独的新的层面 处理
 */


.demo {
    width: 100px;
    height: 100px;
}

.demo:hover {
    will-change: transform;             // 仅在触发绘制前一刻告知浏览器即可          // 性能优化
}

.demo:active {
    transform: scale(2, 3);
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```
























